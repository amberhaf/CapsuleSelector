{"ast":null,"code":"var __extends = this && this.__extends || function () {\n  var _extendStatics = function extendStatics(d, b) {\n    _extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) {\n        if (b.hasOwnProperty(p)) d[p] = b[p];\n      }\n    };\n\n    return _extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    _extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nimport { append, addClass, createElement, isBlazor } from '@syncfusion/ej2-base';\nimport { Year } from './year';\nimport * as event from '../base/constant';\nimport * as cls from '../base/css-constant';\nimport * as util from '../base/util';\n/**\r\n * timeline year view\r\n */\n\nvar TimelineYear =\n/** @class */\nfunction (_super) {\n  __extends(TimelineYear, _super);\n  /**\r\n   * Constructor for timeline year view\r\n   */\n\n\n  function TimelineYear(parent) {\n    var _this = _super.call(this, parent) || this;\n\n    _this.viewClass = 'e-timeline-year-view';\n    _this.isInverseTableSelect = true;\n    return _this;\n  }\n  /**\r\n   * Get module name.\r\n   */\n\n\n  TimelineYear.prototype.getModuleName = function () {\n    return 'timelineYear';\n  };\n\n  TimelineYear.prototype.renderHeader = function (headerWrapper) {\n    var tr = createElement('tr');\n    headerWrapper.appendChild(tr);\n\n    if (this.parent.activeViewOptions.orientation === 'Vertical' && this.parent.activeViewOptions.group.resources.length > 0 && !this.parent.uiStateValues.isGroupAdaptive) {\n      this.parent.resourceBase.renderResourceHeaderIndent(tr);\n    } else {\n      var leftHeaderCells = createElement('td', {\n        className: cls.LEFT_INDENT_CLASS\n      });\n      tr.appendChild(leftHeaderCells);\n      leftHeaderCells.appendChild(this.renderResourceHeader(cls.LEFT_INDENT_WRAP_CLASS));\n    }\n\n    var td = createElement('td');\n    tr.appendChild(td);\n    var container = createElement('div', {\n      className: cls.DATE_HEADER_CONTAINER_CLASS\n    });\n    td.appendChild(container);\n\n    if (this.parent.activeViewOptions.orientation === 'Horizontal' && this.parent.activeViewOptions.group.resources.length > 0 && !this.parent.uiStateValues.isGroupAdaptive) {\n      container.appendChild(this.renderResourceHeader(cls.DATE_HEADER_WRAP_CLASS));\n      this.columnCount = this.colLevels.slice(-1)[0].length;\n    } else {\n      var wrapper = createElement('div', {\n        className: cls.DATE_HEADER_WRAP_CLASS\n      });\n      container.appendChild(wrapper);\n      var table = this.createTableLayout();\n      wrapper.appendChild(table);\n      table.appendChild(this.createTableColGroup(this.columnCount));\n      var innerTr = createElement('tr');\n      table.querySelector('tbody').appendChild(innerTr);\n\n      for (var column = 0; column < this.columnCount; column++) {\n        var innerTd = createElement('td', {\n          className: cls.HEADER_CELLS_CLASS\n        });\n\n        if (this.parent.activeViewOptions.orientation === 'Horizontal') {\n          innerTd.innerHTML = \"<span>\" + this.parent.getDayNames('abbreviated')[column % 7] + \"</span>\";\n        } else {\n          var date = new Date(this.parent.selectedDate.getFullYear(), column, 1);\n          innerTd.innerHTML = \"<span>\" + this.getMonthName(date) + \"</span>\";\n          innerTd.setAttribute('data-date', date.getTime().toString());\n        }\n\n        innerTr.appendChild(innerTd);\n        this.parent.trigger(event.renderCell, {\n          elementType: 'headerCells',\n          element: innerTd\n        });\n      }\n    }\n  };\n\n  TimelineYear.prototype.renderResourceHeader = function (className) {\n    var wrap = createElement('div', {\n      className: className\n    });\n    var tbl = this.createTableLayout();\n    wrap.appendChild(tbl);\n    var trEle = createElement('tr');\n\n    if (this.parent.activeViewOptions.group.resources.length > 0) {\n      this.colLevels = this.generateColumnLevels();\n    } else {\n      var colData = [{\n        className: [cls.HEADER_CELLS_CLASS],\n        type: 'headerCell'\n      }];\n      this.colLevels = [colData];\n    }\n\n    for (var _i = 0, _a = this.colLevels; _i < _a.length; _i++) {\n      var col = _a[_i];\n      var ntr = trEle.cloneNode();\n      var count = className === cls.DATE_HEADER_WRAP_CLASS ? col : [col[0]];\n\n      for (var _b = 0, count_1 = count; _b < count_1.length; _b++) {\n        var c = count_1[_b];\n        var tdEle = createElement('td');\n\n        if (c.className) {\n          addClass([tdEle], c.className);\n        }\n\n        if (className === cls.DATE_HEADER_WRAP_CLASS) {\n          if (c.template) {\n            append(c.template, tdEle);\n          }\n\n          if (c.colSpan) {\n            tdEle.setAttribute('colspan', c.colSpan.toString());\n          }\n\n          this.setResourceHeaderContent(tdEle, c);\n        }\n\n        var args = {\n          elementType: c.type,\n          element: tdEle,\n          date: c.date,\n          groupIndex: c.groupIndex\n        };\n        this.parent.trigger(event.renderCell, args);\n        ntr.appendChild(tdEle);\n      }\n\n      tbl.querySelector('tbody').appendChild(ntr);\n    }\n\n    if (className === cls.DATE_HEADER_WRAP_CLASS) {\n      tbl.appendChild(this.createTableColGroup(this.colLevels.slice(-1)[0].length));\n    }\n\n    return wrap;\n  };\n\n  TimelineYear.prototype.renderContent = function (contentWrapper) {\n    var tr = createElement('tr');\n    contentWrapper.appendChild(tr);\n    var firstTd = createElement('td');\n    var lastTd = createElement('td');\n    var tdCollection = [];\n    var monthTBody;\n\n    if (this.parent.activeViewOptions.orientation === 'Vertical' && this.parent.activeViewOptions.group.resources.length > 0 && !this.parent.uiStateValues.isGroupAdaptive) {\n      tdCollection.push(firstTd);\n      firstTd.appendChild(this.parent.resourceBase.createResourceColumn());\n      this.rowCount = this.parent.resourceBase.lastResourceLevel.length;\n    } else {\n      tdCollection.push(firstTd);\n      var monthWrapper = createElement('div', {\n        className: cls.MONTH_HEADER_WRAPPER\n      });\n      firstTd.appendChild(monthWrapper);\n      monthWrapper.appendChild(this.createTableLayout());\n      monthTBody = monthWrapper.querySelector('tbody');\n    }\n\n    tdCollection.push(lastTd);\n    append(tdCollection, tr);\n    var content = createElement('div', {\n      className: cls.CONTENT_WRAP_CLASS\n    });\n    lastTd.appendChild(content);\n    var contentTable = this.createTableLayout(cls.CONTENT_TABLE_CLASS);\n    content.appendChild(contentTable);\n    var eventWrapper = createElement('div', {\n      className: cls.EVENT_TABLE_CLASS\n    });\n    content.appendChild(eventWrapper);\n    var contentTBody = contentTable.querySelector('tbody');\n\n    if (this.parent.activeViewOptions.group.resources.length > 0 && !this.parent.uiStateValues.isGroupAdaptive) {\n      if (this.parent.rowAutoHeight) {\n        addClass([contentTable], cls.AUTO_HEIGHT);\n      }\n\n      var colCount = this.parent.activeViewOptions.orientation === 'Horizontal' ? this.colLevels.slice(-1)[0].length : 12;\n      contentTable.appendChild(this.createTableColGroup(colCount));\n      this.renderResourceContent(eventWrapper, monthTBody, contentTBody);\n    } else {\n      contentTable.appendChild(this.createTableColGroup(this.columnCount));\n      this.renderDefaultContent(eventWrapper, monthTBody, contentTBody);\n    }\n  };\n\n  TimelineYear.prototype.renderDefaultContent = function (wrapper, monthBody, contentBody) {\n    for (var month = 0; month < this.rowCount; month++) {\n      wrapper.appendChild(createElement('div', {\n        className: cls.APPOINTMENT_CONTAINER_CLASS\n      }));\n      var monthDate = new Date(this.parent.selectedDate.getFullYear(), month, 1);\n      var monthStart = this.parent.calendarUtil.getMonthStartDate(new Date(monthDate.getTime()));\n      var monthEnd = this.parent.calendarUtil.getMonthEndDate(new Date(monthDate.getTime()));\n      var tr = createElement('tr', {\n        attrs: {\n          'role': 'row'\n        }\n      });\n      var monthTr = tr.cloneNode();\n      monthBody.appendChild(monthTr);\n      var contentTr = tr.cloneNode();\n      contentBody.appendChild(contentTr);\n      var monthTd = createElement('td', {\n        className: cls.MONTH_HEADER_CLASS,\n        attrs: {\n          'role': 'gridcell'\n        }\n      });\n\n      if (this.parent.activeViewOptions.orientation === 'Horizontal') {\n        monthTd.setAttribute('data-date', monthDate.getTime().toString());\n        monthTd.innerHTML = \"<span>\" + this.getMonthName(monthDate) + \"</span>\";\n      } else {\n        monthTd.innerHTML = \"<span>\" + this.parent.getDayNames('abbreviated')[month % 7] + \"</span>\";\n      }\n\n      monthTr.appendChild(monthTd);\n      this.parent.trigger(event.renderCell, {\n        elementType: 'leftHeaderCells',\n        element: monthTd\n      });\n      var date = new Date(monthStart.getTime());\n\n      for (var column = 0; column < this.columnCount; column++) {\n        var isDateAvail = void 0;\n\n        if (this.parent.activeViewOptions.orientation === 'Vertical') {\n          monthDate = new Date(this.parent.selectedDate.getFullYear(), column, 1);\n          monthStart = this.parent.calendarUtil.getMonthStartDate(new Date(monthDate.getTime()));\n          monthEnd = this.parent.calendarUtil.getMonthEndDate(new Date(monthDate.getTime()));\n          var dayDate = month - monthStart.getDay() + 1;\n          date = new Date(this.parent.selectedDate.getFullYear(), column, dayDate);\n          isDateAvail = dayDate > 0 && date.getTime() < monthEnd.getTime();\n        } else {\n          isDateAvail = column >= monthStart.getDay() && date.getTime() < monthEnd.getTime();\n        }\n\n        var td = createElement('td', {\n          className: cls.WORK_CELLS_CLASS,\n          attrs: {\n            'role': 'gridcell',\n            'aria-selected': 'false'\n          }\n        });\n        contentTr.appendChild(td);\n        var dateHeader = createElement('div', {\n          className: cls.DATE_HEADER_CLASS + ' ' + cls.NAVIGATE_CLASS,\n          innerHTML: isDateAvail ? date.getDate().toString() : ''\n        });\n        var skeleton = isBlazor() ? 'D' : 'full';\n        var annocementText = this.parent.globalize.formatDate(date, {\n          skeleton: skeleton,\n          calendar: this.parent.getCalendarMode()\n        });\n        dateHeader.setAttribute('aria-label', annocementText);\n\n        if (isDateAvail) {\n          var tds = [td];\n          var classList = [];\n\n          if (this.parent.activeViewOptions.workDays.indexOf(date.getDay()) > -1) {\n            classList.push(cls.WORKDAY_CLASS);\n          }\n\n          if (this.isCurrentDate(date)) {\n            classList.push(cls.CURRENT_DAY_CLASS);\n\n            if (this.parent.activeViewOptions.orientation === 'Horizontal') {\n              tds.push(this.element.querySelector('.' + cls.HEADER_CELLS_CLASS + (\":nth-child(\" + (column + 1) + \")\")));\n            } else {\n              tds.push(this.element.querySelectorAll('.' + cls.MONTH_HEADER_CLASS).item(month));\n            }\n          }\n\n          if (classList.length > 0) {\n            addClass(tds, classList);\n          }\n        } else {\n          addClass([td], cls.OTHERMONTH_CLASS);\n        }\n\n        td.appendChild(dateHeader);\n\n        if (isDateAvail) {\n          td.setAttribute('data-date', date.getTime().toString());\n          this.wireEvents(td, 'cell');\n\n          if (this.parent.activeViewOptions.orientation === 'Horizontal') {\n            date = util.addDays(new Date(date.getTime()), 1);\n          }\n        }\n\n        this.renderCellTemplate({\n          date: date,\n          type: 'workCells'\n        }, td);\n        this.parent.trigger(event.renderCell, {\n          elementType: 'workCells',\n          element: td,\n          date: date\n        });\n      }\n    }\n  };\n\n  TimelineYear.prototype.renderResourceContent = function (wrapper, monthBody, contentBody) {\n    for (var row = 0; row < this.rowCount; row++) {\n      wrapper.appendChild(createElement('div', {\n        className: cls.APPOINTMENT_CONTAINER_CLASS\n      }));\n      var tr = createElement('tr', {\n        attrs: {\n          'role': 'row'\n        }\n      });\n      contentBody.appendChild(tr);\n      var resData = void 0;\n\n      if (this.parent.activeViewOptions.group.resources.length > 0 && !this.parent.uiStateValues.isGroupAdaptive) {\n        resData = this.parent.resourceBase.lastResourceLevel[row];\n      }\n\n      var monthDate = new Date(this.parent.selectedDate.getFullYear(), row, 1);\n      var date = this.parent.calendarUtil.getMonthStartDate(new Date(monthDate.getTime()));\n\n      if (this.parent.activeViewOptions.orientation === 'Horizontal') {\n        var monthTr = tr.cloneNode();\n        monthBody.appendChild(monthTr);\n        var monthTd = createElement('td', {\n          className: cls.MONTH_HEADER_CLASS,\n          innerHTML: \"<span>\" + this.getMonthName(monthDate) + \"</span>\",\n          attrs: {\n            'role': 'gridcell',\n            'data-date': date.getTime().toString()\n          }\n        });\n        monthTr.appendChild(monthTd);\n      }\n\n      for (var month = 0; month < this.columnCount; month++) {\n        var classList = [];\n        var groupIndex = row;\n\n        if (this.parent.activeViewOptions.orientation === 'Vertical') {\n          classList = classList.concat(resData.className);\n\n          if (classList.indexOf(cls.RESOURCE_PARENT_CLASS) > -1) {\n            classList.push(cls.RESOURCE_GROUP_CELLS_CLASS);\n          } else {\n            classList.push(cls.WORKDAY_CLASS);\n          }\n\n          monthDate = new Date(this.parent.selectedDate.getFullYear(), month, 1);\n          date = this.parent.calendarUtil.getMonthStartDate(new Date(monthDate.getTime()));\n        } else {\n          groupIndex = this.colLevels.slice(-1)[0][month].groupIndex;\n          classList.push(cls.WORKDAY_CLASS);\n        }\n\n        var td = createElement('td', {\n          className: cls.WORK_CELLS_CLASS,\n          attrs: {\n            'role': 'gridcell',\n            'aria-selected': 'false',\n            'data-date': date.getTime().toString()\n          }\n        });\n        addClass([td], classList);\n        td.setAttribute('data-group-index', groupIndex.toString());\n        this.renderCellTemplate({\n          date: date,\n          type: 'workCells',\n          groupIndex: groupIndex\n        }, td);\n        this.wireEvents(td, 'cell');\n        tr.appendChild(td);\n        this.parent.trigger(event.renderCell, {\n          elementType: 'workCells',\n          element: td,\n          date: date\n        });\n      }\n    }\n\n    if (this.parent.activeViewOptions.orientation === 'Vertical') {\n      this.collapseRows(this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS));\n    }\n  };\n\n  TimelineYear.prototype.renderCellTemplate = function (data, td) {\n    if (!this.parent.activeViewOptions.cellTemplate) {\n      return;\n    }\n\n    var dateValue = util.addLocalOffset(data.date);\n    var args = {\n      date: dateValue,\n      type: data.type\n    };\n\n    if (data.groupIndex) {\n      args.groupIndex = data.groupIndex;\n    }\n\n    var scheduleId = this.parent.element.id + '_';\n    var viewName = this.parent.activeViewOptions.cellTemplateName;\n    var templateId = scheduleId + viewName + 'cellTemplate';\n    var cellTemplate = [].slice.call(this.parent.getCellTemplate()(args, this.parent, 'cellTemplate', templateId, false));\n    append(cellTemplate, td);\n  };\n\n  TimelineYear.prototype.scrollToDate = function (scrollDate) {\n    if (this.parent.activeViewOptions.group.resources.length === 0) {\n      var date = +new Date(util.resetTime(scrollDate));\n      var element = this.element.querySelector('[data-date=\"' + date + '\"]');\n\n      if (element) {\n        this.getScrollableElement().scrollLeft = element.offsetLeft;\n        this.getScrollableElement().scrollTop = element.offsetTop;\n      }\n    }\n  };\n\n  TimelineYear.prototype.getScrollableElement = function () {\n    if (this.parent.isAdaptive && !this.isTimelineView() && !this.parent.isServerRenderer()) {\n      return this.element.querySelector('.' + cls.SCROLL_CONTAINER_CLASS);\n    } else {\n      return this.getContentAreaElement();\n    }\n  };\n\n  return TimelineYear;\n}(Year);\n\nexport { TimelineYear };","map":null,"metadata":{},"sourceType":"module"}